# /etc/rsyncd.conf

pid file = /run/rsyncd.pid

use chroot = yes
read only = yes

uid = nobody
gid = nobody

{% if hostvars[inventory_hostname]['rsyncConfig']['repos'] is defined %}
{% for repo in hostvars[inventory_hostname]['rsyncConfig']['repos'] %}
[{{ repo['name'] }}]
path = /var/lib/rsync/{{ repo['name'] }}
comment = {{ repo['description'] }}
{% endfor %}
{% endif %}
