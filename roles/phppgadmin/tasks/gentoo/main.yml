---
- name: install packages
  portage:
    name: "{{ item }}"
    quiet: yes
    getbinpkg: yes
  with_items:
    - dev-db/phppgadmin

- name: create config
  template:
    src: gentoo/usr/share/webapps/phppgadmin/5.1/htdocs/conf/config.inc.php.j2
    dest: /usr/share/webapps/phppgadmin/5.1/htdocs/conf/config.inc.php
    owner: root
    group: root
    mode: 0644

- name: copy nginx config
  template:
    src: gentoo/etc/nginx/conf.d/phppgadmin.conf.j2
    dest: /etc/nginx/conf.d/phppgadmin.conf
    owner: root
    group: root
    mode: 0640
  notify:
    - restart nginx
